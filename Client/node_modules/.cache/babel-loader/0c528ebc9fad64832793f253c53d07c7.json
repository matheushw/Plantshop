{"ast":null,"code":"import { all, call, put, takeLatest } from 'redux-saga/effects';\nimport { loadAllOrdersError, loadAllOrdersSuccess, loadAllProductsError, loadAllProductsSuccess, loadUsersError, loadUsersSuccess, placePurchaseOrderError, placePurchaseOrderSuccess, placeRentOrdersError, placeRentOrdersSuccess, signUpUserError, signUpUserSuccess } from './actionCreators';\nimport { ActionTypes } from './actionTypes';\nimport ApiRequester from './apiRequester';\n\n// Worker Saga: will be fired on USER_FETCH_REQUESTED actions\nfunction* fetchUser(action) {\n  try {\n    const user = yield call(ApiRequester.authenticateUser, action.email, action.password);\n    yield put(user.name === undefined ? loadUsersError() : loadUsersSuccess(user));\n  } catch (e) {\n    yield put(loadUsersError());\n  }\n}\n\nfunction* signUpUserSagas(action) {\n  try {\n    const response = yield call(ApiRequester.registerUser, action.name, action.address, action.phoneNumber, action.email, action.password);\n    yield put(response.status === 404 ? signUpUserError() : signUpUserSuccess());\n  } catch (e) {\n    console.log(\"error\");\n    yield put(signUpUserError());\n  }\n}\n\nfunction* loadAllProductsSagas() {\n  try {\n    const products = yield call(ApiRequester.getAllProducts);\n    yield put(products.length === 0 ? loadAllProductsError() : loadAllProductsSuccess(products));\n  } catch (e) {\n    yield put(loadAllProductsError());\n  }\n}\n\nfunction* placePurchaseOrderSagas(action) {\n  try {\n    const response = yield call(ApiRequester.placePurchaseOrder, action.user, action.order);\n    yield put((response === null || response === void 0 ? void 0 : response.status) === 200 ? placePurchaseOrderSuccess() : placePurchaseOrderError());\n  } catch (e) {\n    yield put(placePurchaseOrderError());\n  }\n}\n\nfunction* placeRentOrdersSagas(action) {\n  try {\n    const response = yield call(ApiRequester.placeRentOrders, action.user, action.rentOrders);\n    yield put((response === null || response === void 0 ? void 0 : response.status) === 200 ? placeRentOrdersSuccess() : placeRentOrdersError());\n  } catch (e) {\n    yield put(placeRentOrdersError());\n  }\n}\n\nfunction* loadAllOrdersSagas(action) {\n  try {\n    const purchaseOrders = yield call(ApiRequester.getAllPurchaseOrders, action.user);\n    const rentOrders = yield call(ApiRequester.getAllRentOrders, action.user);\n    let rentOrdersDTO = [];\n\n    if ((rentOrders === null || rentOrders === void 0 ? void 0 : rentOrders.status) === 200) {\n      var _rentOrders$data;\n\n      rentOrdersDTO = (_rentOrders$data = rentOrders.data) === null || _rentOrders$data === void 0 ? void 0 : _rentOrders$data.map(rentOrder => ({ ...rentOrder,\n        startDate: new Date(rentOrder.startDate),\n        endDate: new Date(rentOrder.endDate)\n      }));\n    }\n\n    yield put((purchaseOrders === null || purchaseOrders === void 0 ? void 0 : purchaseOrders.status) === 200 && (rentOrders === null || rentOrders === void 0 ? void 0 : rentOrders.status) === 200 ? loadAllOrdersSuccess(purchaseOrders.data, rentOrdersDTO) : loadAllOrdersError());\n  } catch (e) {\n    yield put(loadAllOrdersError());\n  }\n}\n\nfunction* mySaga() {\n  yield all([takeLatest(ActionTypes.LOAD_USER_REQUEST, fetchUser), takeLatest(ActionTypes.LOAD_ALL_PRODUCTS_REQUEST, loadAllProductsSagas), takeLatest(ActionTypes.SIGN_UP_USER_REQUEST, signUpUserSagas), takeLatest(ActionTypes.PLACE_PURCHASE_ORDER_REQUEST, placePurchaseOrderSagas), takeLatest(ActionTypes.PLACE_RENT_ORDERS_REQUEST, placeRentOrdersSagas), takeLatest(ActionTypes.LOAD_ALL_ORDERS_REQUEST, loadAllOrdersSagas), takeLatest(ActionTypes.SIGN_UP_USER_REQUEST, signUpUserSagas)]);\n}\n\nexport default mySaga;","map":{"version":3,"sources":["/Users/matheuscunha/USP/Plantshop/src/store/sagas.ts"],"names":["all","call","put","takeLatest","loadAllOrdersError","loadAllOrdersSuccess","loadAllProductsError","loadAllProductsSuccess","loadUsersError","loadUsersSuccess","placePurchaseOrderError","placePurchaseOrderSuccess","placeRentOrdersError","placeRentOrdersSuccess","signUpUserError","signUpUserSuccess","ActionTypes","ApiRequester","fetchUser","action","user","authenticateUser","email","password","name","undefined","e","signUpUserSagas","response","registerUser","address","phoneNumber","status","console","log","loadAllProductsSagas","products","getAllProducts","length","placePurchaseOrderSagas","placePurchaseOrder","order","placeRentOrdersSagas","placeRentOrders","rentOrders","loadAllOrdersSagas","purchaseOrders","getAllPurchaseOrders","getAllRentOrders","rentOrdersDTO","data","map","rentOrder","startDate","Date","endDate","mySaga","LOAD_USER_REQUEST","LOAD_ALL_PRODUCTS_REQUEST","SIGN_UP_USER_REQUEST","PLACE_PURCHASE_ORDER_REQUEST","PLACE_RENT_ORDERS_REQUEST","LOAD_ALL_ORDERS_REQUEST"],"mappings":"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","sourcesContent":["import { all, call, put, takeLatest } from 'redux-saga/effects'\nimport { loadAllOrdersError, loadAllOrdersSuccess, loadAllProductsError, loadAllProductsSuccess, loadUsersError, loadUsersSuccess, placePurchaseOrderError, placePurchaseOrderSuccess, placeRentOrdersError, placeRentOrdersSuccess, signUpUserError, signUpUserSuccess } from './actionCreators';\nimport { LoadAllOrdersRequest, LoadAllProductsRequest, LoadUsersRequest, PlacePurchaseOrderRequest, PlaceRentOrdersRequest, SignUpUserRequest } from './actions';\nimport { ActionTypes } from './actionTypes';\nimport ApiRequester from './apiRequester'\nimport { RentOrder } from './types';\n\n// Worker Saga: will be fired on USER_FETCH_REQUESTED actions\n\nfunction* fetchUser(action: LoadUsersRequest) : any {\n  try {\n    const user = yield call(ApiRequester.authenticateUser, action.email, action.password);\n    yield put(user.name === undefined ? loadUsersError() : loadUsersSuccess(user));\n  } catch (e) {\n    yield put(loadUsersError());\n  }\n}\n\nfunction* signUpUserSagas(action: SignUpUserRequest) : any {\n  try {\n    const response = yield call(ApiRequester.registerUser, action.name, action.address, action.phoneNumber, action.email, action.password);\n    yield put(response.status === 404 ? signUpUserError() : signUpUserSuccess());\n  } catch (e) {\n    console.log(\"error\")\n    yield put(signUpUserError());\n  }\n}\n\nfunction* loadAllProductsSagas() : any {\n  try {\n    const products = yield call(ApiRequester.getAllProducts);\n    yield put(products.length === 0 ? loadAllProductsError() : loadAllProductsSuccess(products));\n  } catch (e) {\n    yield put(loadAllProductsError());\n  }\n}\n\nfunction* placePurchaseOrderSagas(action: PlacePurchaseOrderRequest) : any {\n  try {\n    const response = yield call(ApiRequester.placePurchaseOrder, action.user, action.order);\n    yield put(response?.status=== 200? placePurchaseOrderSuccess() : placePurchaseOrderError());\n  } catch (e) {\n    yield put(placePurchaseOrderError());\n  }\n}\n\nfunction* placeRentOrdersSagas(action: PlaceRentOrdersRequest) : any {\n  try {\n    const response = yield call(ApiRequester.placeRentOrders, action.user, action.rentOrders);\n    yield put(response?.status=== 200? placeRentOrdersSuccess() : placeRentOrdersError());\n  } catch (e) {\n    yield put(placeRentOrdersError());\n  }\n}\n\nfunction* loadAllOrdersSagas(action: LoadAllOrdersRequest) : any {\n  try {\n    const purchaseOrders = yield call(ApiRequester.getAllPurchaseOrders, action.user);\n    const rentOrders = yield call(ApiRequester.getAllRentOrders, action.user);\n\n    let rentOrdersDTO: RentOrder[] = [];\n\n    if(rentOrders?.status === 200){ \n      rentOrdersDTO = rentOrders.data?.map((rentOrder: any) => <RentOrder> {\n        ...rentOrder, startDate: new Date(rentOrder.startDate), endDate: new Date(rentOrder.endDate)\n      });\n    }\n\n    yield put(\n      purchaseOrders?.status === 200 && rentOrders?.status=== 200? \n        loadAllOrdersSuccess(purchaseOrders.data, rentOrdersDTO) : loadAllOrdersError()\n    );\n  } catch (e) {\n    yield put(loadAllOrdersError());\n  }\n}\n\nfunction* mySaga() {\n  yield all([\n    takeLatest(ActionTypes.LOAD_USER_REQUEST, fetchUser),\n    takeLatest(ActionTypes.LOAD_ALL_PRODUCTS_REQUEST, loadAllProductsSagas),\n    takeLatest(ActionTypes.SIGN_UP_USER_REQUEST, signUpUserSagas),\n    takeLatest(ActionTypes.PLACE_PURCHASE_ORDER_REQUEST, placePurchaseOrderSagas),\n    takeLatest(ActionTypes.PLACE_RENT_ORDERS_REQUEST, placeRentOrdersSagas),\n    takeLatest(ActionTypes.LOAD_ALL_ORDERS_REQUEST, loadAllOrdersSagas),\n    takeLatest(ActionTypes.SIGN_UP_USER_REQUEST, signUpUserSagas),\n  ]);\n}\n\nexport default mySaga;"]},"metadata":{},"sourceType":"module"}