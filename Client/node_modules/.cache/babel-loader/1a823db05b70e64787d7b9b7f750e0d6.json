{"ast":null,"code":"import produce from 'immer';\nimport { mockedUsers } from '../mock-objects/usersList';\nimport { products } from '../mock-objects/products';\nexport const initialState = {\n  loading: {\n    user: false\n  },\n  user: null,\n  products: products,\n  cartProducts: [],\n  usersList: mockedUsers,\n  orders: []\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case \"loadUsersRequest\":\n      return produce(state, draft => {\n        draft.loading.user = true;\n      });\n\n    case \"loadUsersSuccess\":\n      return produce(state, draft => {\n        draft.loading.user = false;\n        draft.user = action.user;\n      });\n\n    case \"loadUsersError\":\n      return produce(state, draft => {\n        draft.loading.user = false;\n      });\n\n    case \"addProductToChart\":\n      return produce(state, draft => {\n        draft.cartProducts = state.cartProducts.concat([action.product]);\n      });\n\n    case \"removeProductToChart\":\n      return produce(state, draft => {\n        // draft.cartProducts = state.cartProducts.filter((value) => value.id !== action.id);\n        draft.cartProducts = [];\n        let removed = false;\n        state.cartProducts.forEach(product => {\n          if (!removed && product.id === action.id) {\n            removed = true;\n          } else {\n            draft.cartProducts.push(product);\n          }\n        });\n      });\n\n    case \"placeOrder\":\n      return produce(state, draft => {\n        const date = new Date();\n        let totalPrice = 0;\n        let products = new Map();\n        action.products.forEach(product => {\n          totalPrice += parseFloat(product.price);\n\n          if (products.has(product.id)) {\n            const auxProduct = products.get(product.id);\n            products.set(product.id, { ...auxProduct,\n              quantity: auxProduct.quantity + 1\n            });\n          } else {\n            const newProductOrder = {\n              id: product.id,\n              name: product.name,\n              price: product.price,\n              quantity: 1\n            };\n            products.set(product.id, newProductOrder);\n          }\n        });\n        let productsOrders = [];\n        products.forEach(productOrder => productsOrders.push(productOrder));\n        const newOrder = {\n          productsOrders: productsOrders,\n          date: date.getDate() + \"/\" + date.getMonth() + \"/\" + date.getFullYear(),\n          total: totalPrice.toFixed(2),\n          status: \"Preparando para envio!\"\n        };\n        draft.orders = state.orders;\n        draft.orders.push(newOrder);\n      });\n\n    case \"clearCart\":\n      return produce(state, draft => {\n        draft.cartProducts = [];\n      });\n\n    case \"logInUser\":\n      return produce(state, draft => {\n        draft.user = action.user;\n      });\n\n    case \"signUpUser\":\n      return produce(state, draft => {\n        const user = {\n          id: state.usersList.length.toString(),\n          email: action.email,\n          password: action.password,\n          name: action.name,\n          address: action.address,\n          phoneNumber: action.phoneNumber,\n          role: 'user'\n        };\n        draft.user = user;\n        draft.usersList.push(draft.user);\n      });\n\n    case \"addInventory\":\n      return produce(state, draft => {\n        draft.products.forEach((product, index) => {\n          if (product.id === action.productId) {\n            draft.products[index].quantity++;\n          }\n        });\n      });\n\n    case \"removeInventory\":\n      return produce(state, draft => {\n        draft.products.forEach((product, index) => {\n          if (product.id === action.productId) {\n            draft.products[index].quantity--;\n          }\n        });\n      });\n\n    case \"removeProduct\":\n      return produce(state, draft => {\n        draft.user = action.user;\n      });\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer;","map":{"version":3,"sources":["/Users/matheuscunha/USP/Plantshop/ps/src/store/reducer.ts"],"names":["produce","mockedUsers","products","initialState","loading","user","cartProducts","usersList","orders","reducer","state","action","type","draft","concat","product","removed","forEach","id","push","date","Date","totalPrice","Map","parseFloat","price","has","auxProduct","get","set","quantity","newProductOrder","name","productsOrders","productOrder","newOrder","getDate","getMonth","getFullYear","total","toFixed","status","length","toString","email","password","address","phoneNumber","role","index","productId"],"mappings":"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","sourcesContent":["import produce from 'immer';\nimport { mockedUsers } from '../mock-objects/usersList';\nimport { products } from '../mock-objects/products';\nimport { ApplicationState, ApplicationAction, User, Order, ProductOrder } from './types';\n\nexport const initialState: ApplicationState = {\n  loading: {\n    user: false,\n  },\n  user: null,\n  products: products,\n  cartProducts: [],\n  usersList: mockedUsers,\n  orders: [],\n}\n\nconst reducer = (state = initialState, action: ApplicationAction) => {\n  switch (action.type) {\n    case \"loadUsersRequest\":\n      return produce(state, draft => {\n        draft.loading.user = true;\n      });\n    case \"loadUsersSuccess\":\n      return produce(state, draft => {\n        draft.loading.user = false;\n        draft.user = action.user;\n      });\n    case \"loadUsersError\":\n      return produce(state, draft => {\n        draft.loading.user = false;\n      });\n    case \"addProductToChart\":\n      return produce(state, draft => {\n        draft.cartProducts = state.cartProducts.concat([action.product]);\n      });\n    case \"removeProductToChart\":\n      return produce(state, draft => {\n        // draft.cartProducts = state.cartProducts.filter((value) => value.id !== action.id);\n        draft.cartProducts = [];\n        let removed: boolean = false;\n        state.cartProducts.forEach((product) => {\n          if(!removed && product.id === action.id){\n            removed = true;\n          } else {\n            draft.cartProducts.push(product);\n          }\n        })\n      });\n    case \"placeOrder\":\n      return produce(state, draft => {\n\n        const date = new Date();\n        let totalPrice: number = 0;\n        let products: Map<string, ProductOrder> = new Map<string, ProductOrder>();\n\n        action.products.forEach((product) => {\n          totalPrice += parseFloat(product.price);\n\n          if (products.has(product.id)){\n            const auxProduct = products.get(product.id)!;\n            products.set(product.id, {...auxProduct, quantity: auxProduct.quantity + 1});\n          } else {\n            const newProductOrder: ProductOrder = {\n              id: product.id, \n              name: product.name, \n              price: product.price, \n              quantity: 1 \n            };\n            products.set(product.id, newProductOrder);\n          }\n\n        });\n\n        let productsOrders: ProductOrder[] = [];\n\n        products.forEach((productOrder) => productsOrders.push(productOrder));\n        \n        const newOrder: Order ={\n          productsOrders: productsOrders,\n          date: date.getDate() + \"/\" + date.getMonth() + \"/\" + date.getFullYear(),\n          total: totalPrice.toFixed(2),\n          status: \"Preparando para envio!\",\n        }\n        draft.orders = state.orders;\n        draft.orders.push(newOrder);\n      });\n    case \"clearCart\":\n      return produce(state, draft => {\n        draft.cartProducts = [];\n      });\n    case \"logInUser\":\n      return produce(state, draft => {\n        draft.user = action.user;\n      });\n    case \"signUpUser\":\n      return produce(state, draft => {\n        const user: User = {\n            id: (state.usersList.length).toString(),\n            email: action.email,\n            password: action.password,\n            name: action.name,\n            address: action.address,\n            phoneNumber: action.phoneNumber,\n            role: 'user',\n        }\n        draft.user = user;\n        draft.usersList.push(draft.user); \n      });\n    case \"addInventory\":\n      return produce(state, draft => {\n        draft.products.forEach((product, index) => {\n          if(product.id === action.productId){\n            draft.products[index].quantity++;\n          }\n        })\n      });\n\n    case \"removeInventory\":\n      return produce(state, draft => {\n        draft.products.forEach((product, index) => {\n          if(product.id === action.productId){\n            draft.products[index].quantity--;\n          }\n        })\n      });\n      \n    case \"removeProduct\":\n      return produce(state, draft => {\n        draft.user = action.user;\n      });\n    default:\n      return state;\n  }\n}\n\nexport default reducer;"]},"metadata":{},"sourceType":"module"}