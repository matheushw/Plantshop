{"ast":null,"code":"var _jsxFileName = \"/Users/matheuscunha/USP/Plantshop/src/packages/cart/src/components/ChartPage/ChartPage.tsx\",\n    _s = $RefreshSig$();\n\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { clearProductInCartRequest, minusProductInCartRequest, placePurchaseOrderNotAsked, placePurchaseOrderRequest, placeRentOrdersNotAsked, placeRentOrdersRequest, plusProductInCartRequest, removeProductFromCartRequest, removeRentOrderRequest } from '../../../../../store/actionCreators';\nimport ChartProduct from '../ChartProduct/ChartProduct';\nimport * as styles from './styles';\nimport ReactNotification, { store } from 'react-notifications-component';\nimport 'react-notifications-component/dist/theme.css';\nimport ChartRent from '../ChartRent/ChartRent';\nimport ProductList from '../ProductList';\nimport { useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ChartPage = props => {\n  _s();\n\n  useEffect(() => {\n    if (props.success.get('placePurchaseOrder')) {\n      props.placePurchaseNotAsked();\n    } else if (props.success.get('placeRentOrders')) {\n      props.placeRentNotAsked();\n    }\n  }, [props.success]);\n\n  const getFinalPrice = () => {\n    let finalPrice = 0.0;\n    props.cartProducts.forEach(product => {\n      finalPrice += parseFloat(product.price) * product.quantity;\n    });\n    props.rentOrders.forEach(rentOrder => finalPrice += parseFloat(rentOrder.total));\n    return finalPrice;\n  };\n\n  const placePurchaseOrder = () => {\n    if (props.cartProducts.size !== 0) {\n      let totalPrice = 0;\n      let productsOrders = [];\n      props.cartProducts.forEach(product => {\n        totalPrice += parseFloat(product.price) * product.quantity;\n        const newProductOrder = {\n          id: product.id,\n          name: product.name,\n          price: product.price,\n          quantity: product.quantity\n        }; // draft.products.forEach((value, idx) => {\n        //   if(value.id === product.id){\n        //     draft.products[idx].quantity -= product.quantity;\n        //   }\n        // })\n\n        productsOrders.push(newProductOrder);\n      });\n      var day = new Date();\n      var dd = day.getDate().toString();\n      var mm = (day.getMonth() + 1).toString();\n      var yyyy = day.getFullYear().toString();\n\n      if (parseInt(dd) < 10) {\n        dd = '0' + dd;\n      }\n\n      if (parseInt(mm) < 10) {\n        mm = '0' + mm;\n      }\n\n      const newOrder = {\n        productsOrders: productsOrders,\n        date: dd + \"/\" + mm + \"/\" + yyyy,\n        total: totalPrice.toFixed(2),\n        status: \"Preparando para envio!\"\n      };\n      props.placePurchaseOrder(props.user, newOrder);\n    }\n\n    if (props.rentOrders.length !== 0) {\n      props.placeRentOrders(props.rentOrders, props.user);\n    } // props.clearCart();\n\n\n    store.addNotification({\n      title: \"Pedido feito com sucesso!\",\n      message: \" \",\n      type: \"success\",\n      insert: \"top\",\n      container: \"top-left\",\n      animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n      animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n      dismiss: {\n        duration: 2000,\n        onScreen: false\n      }\n    });\n  };\n\n  const notifyLogin = () => {\n    store.addNotification({\n      title: \"Por favor faça login antes de finalizar a compra.\",\n      message: \" \",\n      type: \"warning\",\n      insert: \"top\",\n      container: \"top-left\",\n      animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n      animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n      dismiss: {\n        duration: 2000,\n        onScreen: false\n      }\n    });\n  };\n\n  const renderRentOrder = (rentOrder, idx) => {\n    return /*#__PURE__*/_jsxDEV(ChartRent, {\n      removeRentOrder: props.removeRentOrder,\n      rentOrder: rentOrder\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }, this);\n  };\n\n  const renderProduts = cartProducts => {\n    const cartProductElements = [];\n    cartProducts.forEach(cartProduct => {\n      cartProductElements.push( /*#__PURE__*/_jsxDEV(ChartProduct, {\n        img: cartProduct.img,\n        name: cartProduct.name,\n        price: cartProduct.price,\n        quantity: cartProduct.quantity,\n        id: cartProduct.id,\n        removeProduct: props.removeProduct,\n        minusProduct: props.minusProduct,\n        plusProduct: props.plusProduct\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }, this));\n    });\n    return cartProductElements;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.productDisplay,\n    children: [/*#__PURE__*/_jsxDEV(ReactNotification, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Seus Produtos\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.productList,\n      children: [props.cartProducts.size !== 0 && /*#__PURE__*/_jsxDEV(ProductList, {\n        products: renderProduts(props.cartProducts),\n        title: \"Compras\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 43\n      }, this), props.rentOrders.length !== 0 && /*#__PURE__*/_jsxDEV(ProductList, {\n        products: props.rentOrders.map(renderRentOrder),\n        title: \"Alugueis\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 43\n      }, this), props.cartProducts.size === 0 && props.rentOrders.length === 0 && /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Voc\\xEA n\\xE3o tem nenhum produto no carrinho :(\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 76\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }, this), (props.cartProducts.size !== 0 || props.rentOrders.length !== 0) && /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [\"Total: \", \"R$ \" + getFinalPrice().toFixed(2)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 76\n    }, this), (props.cartProducts.size !== 0 || props.rentOrders.length !== 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Continuar comprando\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 24\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 11\n      }, this), props.user !== null && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: placePurchaseOrder,\n        children: \"Finalizar compra\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 35\n      }, this), props.user === null && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: notifyLogin,\n        children: \"Finalizar compra\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 35\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ChartPage, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = ChartPage;\n\nconst mapStateToProps = state => ({\n  cartProducts: state.cartProducts,\n  rentOrders: state.rentOrders,\n  user: state.user,\n  loadings: state.loading,\n  errors: state.error,\n  success: state.success\n});\n\nconst mapDispatchToProps = dispatch => ({\n  removeProduct: id => {\n    dispatch(removeProductFromCartRequest(id));\n  },\n  placePurchaseOrder: (user, order) => {\n    dispatch(placePurchaseOrderRequest(user, order));\n  },\n  clearCart: () => {\n    dispatch(clearProductInCartRequest());\n  },\n  placeRentOrders: (rentOrders, user) => {\n    dispatch(placeRentOrdersRequest(rentOrders, user));\n  },\n  minusProduct: id => {\n    dispatch(minusProductInCartRequest(id));\n  },\n  plusProduct: id => {\n    dispatch(plusProductInCartRequest(id));\n  },\n  removeRentOrder: rentOrderId => {\n    dispatch(removeRentOrderRequest(rentOrderId));\n  },\n  placePurchaseNotAsked: () => {\n    dispatch(placePurchaseOrderNotAsked());\n  },\n  placeRentNotAsked: () => {\n    dispatch(placeRentOrdersNotAsked());\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChartPage);\n\nvar _c;\n\n$RefreshReg$(_c, \"ChartPage\");","map":{"version":3,"sources":["/Users/matheuscunha/USP/Plantshop/src/packages/cart/src/components/ChartPage/ChartPage.tsx"],"names":["connect","Link","clearProductInCartRequest","minusProductInCartRequest","placePurchaseOrderNotAsked","placePurchaseOrderRequest","placeRentOrdersNotAsked","placeRentOrdersRequest","plusProductInCartRequest","removeProductFromCartRequest","removeRentOrderRequest","ChartProduct","styles","ReactNotification","store","ChartRent","ProductList","useEffect","ChartPage","props","success","get","placePurchaseNotAsked","placeRentNotAsked","getFinalPrice","finalPrice","cartProducts","forEach","product","parseFloat","price","quantity","rentOrders","rentOrder","total","placePurchaseOrder","size","totalPrice","productsOrders","newProductOrder","id","name","push","day","Date","dd","getDate","toString","mm","getMonth","yyyy","getFullYear","parseInt","newOrder","date","toFixed","status","user","length","placeRentOrders","addNotification","title","message","type","insert","container","animationIn","animationOut","dismiss","duration","onScreen","notifyLogin","renderRentOrder","idx","removeRentOrder","renderProduts","cartProductElements","cartProduct","img","removeProduct","minusProduct","plusProduct","productDisplay","productList","map","mapStateToProps","state","loadings","loading","errors","error","mapDispatchToProps","dispatch","order","clearCart","rentOrderId"],"mappings":";;;AAAA,SAASA,OAAT,QAAwB,aAAxB;AAEA,SAASC,IAAT,QAAqB,kBAArB;AACA,SAASC,yBAAT,EAAoCC,yBAApC,EAA+DC,0BAA/D,EAA2FC,yBAA3F,EAAsHC,uBAAtH,EAA+IC,sBAA/I,EAAuKC,wBAAvK,EAAiMC,4BAAjM,EAA+NC,sBAA/N,QAA6P,qCAA7P;AAEA,OAAOC,YAAP,MAA0B,8BAA1B;AACA,OAAO,KAAKC,MAAZ,MAAwB,UAAxB;AACA,OAAOC,iBAAP,IAA4BC,KAA5B,QAAyC,+BAAzC;AACA,OAAO,8CAAP;AACA,OAAOC,SAAP,MAAsB,wBAAtB;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AAEA,SAASC,SAAT,QAA0B,OAA1B;;;AAoBA,MAAMC,SAAmC,GAAIC,KAAD,IAAW;AAAA;;AAErDF,EAAAA,SAAS,CAAC,MAAM;AACd,QAAGE,KAAK,CAACC,OAAN,CAAcC,GAAd,CAAkB,oBAAlB,CAAH,EAA2C;AACzCF,MAAAA,KAAK,CAACG,qBAAN;AACD,KAFD,MAEO,IAAIH,KAAK,CAACC,OAAN,CAAcC,GAAd,CAAkB,iBAAlB,CAAJ,EAAyC;AAC9CF,MAAAA,KAAK,CAACI,iBAAN;AACD;AACF,GANQ,EAMN,CAACJ,KAAK,CAACC,OAAP,CANM,CAAT;;AAQA,QAAMI,aAAa,GAAG,MAAM;AAC1B,QAAIC,UAAkB,GAAG,GAAzB;AAEAN,IAAAA,KAAK,CAACO,YAAN,CAAmBC,OAAnB,CAA4BC,OAAD,IAAa;AACtCH,MAAAA,UAAU,IAAII,UAAU,CAACD,OAAO,CAACE,KAAT,CAAV,GAA4BF,OAAO,CAACG,QAAlD;AACD,KAFD;AAIAZ,IAAAA,KAAK,CAACa,UAAN,CAAiBL,OAAjB,CAA0BM,SAAD,IAAeR,UAAU,IAAII,UAAU,CAACI,SAAS,CAACC,KAAX,CAAhE;AAEA,WAAOT,UAAP;AACD,GAVD;;AAYA,QAAMU,kBAAkB,GAAG,MAAM;AAE/B,QAAGhB,KAAK,CAACO,YAAN,CAAmBU,IAAnB,KAA4B,CAA/B,EAAiC;AAC/B,UAAIC,UAAkB,GAAG,CAAzB;AACA,UAAIC,cAA8B,GAAG,EAArC;AAEAnB,MAAAA,KAAK,CAACO,YAAN,CAAmBC,OAAnB,CAA4BC,OAAD,IAAa;AACtCS,QAAAA,UAAU,IAAIR,UAAU,CAACD,OAAO,CAACE,KAAT,CAAV,GAA4BF,OAAO,CAACG,QAAlD;AAEA,cAAMQ,eAA6B,GAAG;AACpCC,UAAAA,EAAE,EAAEZ,OAAO,CAACY,EADwB;AAEpCC,UAAAA,IAAI,EAAEb,OAAO,CAACa,IAFsB;AAGpCX,UAAAA,KAAK,EAAEF,OAAO,CAACE,KAHqB;AAIpCC,UAAAA,QAAQ,EAAEH,OAAO,CAACG;AAJkB,SAAtC,CAHsC,CAUtC;AACA;AACA;AACA;AACA;;AAEAO,QAAAA,cAAc,CAACI,IAAf,CAAoBH,eAApB;AACD,OAjBD;AAmBA,UAAII,GAAG,GAAG,IAAIC,IAAJ,EAAV;AACA,UAAIC,EAAE,GAAGF,GAAG,CAACG,OAAJ,GAAcC,QAAd,EAAT;AACA,UAAIC,EAAE,GAAG,CAACL,GAAG,CAACM,QAAJ,KAAe,CAAhB,EAAmBF,QAAnB,EAAT;AACA,UAAIG,IAAI,GAAIP,GAAG,CAACQ,WAAJ,EAAD,CAAoBJ,QAApB,EAAX;;AACA,UAAGK,QAAQ,CAACP,EAAD,CAAR,GAAe,EAAlB,EAAqB;AACnBA,QAAAA,EAAE,GAAG,MAAMA,EAAX;AACD;;AACD,UAAGO,QAAQ,CAACJ,EAAD,CAAR,GAAa,EAAhB,EAAmB;AACjBA,QAAAA,EAAE,GAAG,MAAMA,EAAX;AACD;;AAED,YAAMK,QAAe,GAAG;AACtBf,QAAAA,cAAc,EAAEA,cADM;AAEtBgB,QAAAA,IAAI,EAAET,EAAE,GAAG,GAAL,GAAWG,EAAX,GAAgB,GAAhB,GAAsBE,IAFN;AAGtBhB,QAAAA,KAAK,EAAEG,UAAU,CAACkB,OAAX,CAAmB,CAAnB,CAHe;AAItBC,QAAAA,MAAM,EAAE;AAJc,OAAxB;AAOArC,MAAAA,KAAK,CAACgB,kBAAN,CAAyBhB,KAAK,CAACsC,IAA/B,EAAsCJ,QAAtC;AACD;;AAED,QAAGlC,KAAK,CAACa,UAAN,CAAiB0B,MAAjB,KAA4B,CAA/B,EAAkC;AAChCvC,MAAAA,KAAK,CAACwC,eAAN,CAAsBxC,KAAK,CAACa,UAA5B,EAAwCb,KAAK,CAACsC,IAA9C;AACD,KAhD8B,CAkD/B;;;AAEA3C,IAAAA,KAAK,CAAC8C,eAAN,CAAsB;AACpBC,MAAAA,KAAK,EAAE,2BADa;AAEpBC,MAAAA,OAAO,EAAE,GAFW;AAGpBC,MAAAA,IAAI,EAAE,SAHc;AAIpBC,MAAAA,MAAM,EAAE,KAJY;AAKpBC,MAAAA,SAAS,EAAE,UALS;AAMpBC,MAAAA,WAAW,EAAE,CAAC,mBAAD,EAAsB,iBAAtB,CANO;AAOpBC,MAAAA,YAAY,EAAE,CAAC,mBAAD,EAAsB,kBAAtB,CAPM;AAQpBC,MAAAA,OAAO,EAAE;AACPC,QAAAA,QAAQ,EAAE,IADH;AAEPC,QAAAA,QAAQ,EAAE;AAFH;AARW,KAAtB;AAaD,GAjED;;AAkEA,QAAMC,WAAW,GAAG,MAAM;AACtBzD,IAAAA,KAAK,CAAC8C,eAAN,CAAsB;AACpBC,MAAAA,KAAK,EAAE,mDADa;AAEpBC,MAAAA,OAAO,EAAE,GAFW;AAGpBC,MAAAA,IAAI,EAAE,SAHc;AAIpBC,MAAAA,MAAM,EAAE,KAJY;AAKpBC,MAAAA,SAAS,EAAE,UALS;AAMpBC,MAAAA,WAAW,EAAE,CAAC,mBAAD,EAAsB,iBAAtB,CANO;AAOpBC,MAAAA,YAAY,EAAE,CAAC,mBAAD,EAAsB,kBAAtB,CAPM;AAQpBC,MAAAA,OAAO,EAAE;AACPC,QAAAA,QAAQ,EAAE,IADH;AAEPC,QAAAA,QAAQ,EAAE;AAFH;AARW,KAAtB;AAaH,GAdD;;AAgBA,QAAME,eAAe,GAAG,CAACvC,SAAD,EAAuBwC,GAAvB,KAAuC;AAC7D,wBAAQ,QAAC,SAAD;AAAW,MAAA,eAAe,EAAEtD,KAAK,CAACuD,eAAlC;AAAmD,MAAA,SAAS,EAAEzC;AAA9D;AAAA;AAAA;AAAA;AAAA,YAAR;AACD,GAFD;;AAIA,QAAM0C,aAAa,GAAIjD,YAAD,IAA4C;AAEhE,UAAMkD,mBAAmC,GAAG,EAA5C;AAEAlD,IAAAA,YAAY,CAACC,OAAb,CAAsBkD,WAAD,IAAiB;AACpCD,MAAAA,mBAAmB,CAAClC,IAApB,eACE,QAAC,YAAD;AACE,QAAA,GAAG,EAAEmC,WAAW,CAACC,GADnB;AAEE,QAAA,IAAI,EAAED,WAAW,CAACpC,IAFpB;AAGE,QAAA,KAAK,EAAEoC,WAAW,CAAC/C,KAHrB;AAIE,QAAA,QAAQ,EAAE+C,WAAW,CAAC9C,QAJxB;AAKE,QAAA,EAAE,EAAE8C,WAAW,CAACrC,EALlB;AAME,QAAA,aAAa,EAAErB,KAAK,CAAC4D,aANvB;AAOE,QAAA,YAAY,EAAE5D,KAAK,CAAC6D,YAPtB;AAQE,QAAA,WAAW,EAAE7D,KAAK,CAAC8D;AARrB;AAAA;AAAA;AAAA;AAAA,cADF;AAWD,KAZD;AAcA,WAAOL,mBAAP;AACD,GAnBD;;AAqBA,sBACE;AAAK,IAAA,SAAS,EAAEhE,MAAM,CAACsE,cAAvB;AAAA,4BACE,QAAC,iBAAD;AAAA;AAAA;AAAA;AAAA,YADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFF,eAKE;AAAK,MAAA,SAAS,EAAEtE,MAAM,CAACuE,WAAvB;AAAA,iBAEGhE,KAAK,CAACO,YAAN,CAAmBU,IAAnB,KAA4B,CAA5B,iBAAiC,QAAC,WAAD;AAAa,QAAA,QAAQ,EAAEuC,aAAa,CAACxD,KAAK,CAACO,YAAP,CAApC;AAA0D,QAAA,KAAK,EAAE;AAAjE;AAAA;AAAA;AAAA;AAAA,cAFpC,EAKGP,KAAK,CAACa,UAAN,CAAiB0B,MAAjB,KAA4B,CAA5B,iBAAiC,QAAC,WAAD;AAAa,QAAA,QAAQ,EAAEvC,KAAK,CAACa,UAAN,CAAiBoD,GAAjB,CAAqBZ,eAArB,CAAvB;AAA8D,QAAA,KAAK,EAAE;AAArE;AAAA;AAAA;AAAA;AAAA,cALpC,EAMGrD,KAAK,CAACO,YAAN,CAAmBU,IAAnB,KAA4B,CAA5B,IAAiCjB,KAAK,CAACa,UAAN,CAAiB0B,MAAjB,KAA4B,CAA7D,iBAAkE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cANrE;AAAA;AAAA;AAAA;AAAA;AAAA,YALF,EAcG,CAACvC,KAAK,CAACO,YAAN,CAAmBU,IAAnB,KAA4B,CAA5B,IAAiCjB,KAAK,CAACa,UAAN,CAAiB0B,MAAjB,KAA4B,CAA9D,kBAAoE;AAAA,4BAAY,QAAQlC,aAAa,GAAG+B,OAAhB,CAAwB,CAAxB,CAApB;AAAA;AAAA;AAAA;AAAA;AAAA,YAdvE,EAeG,CAACpC,KAAK,CAACO,YAAN,CAAmBU,IAAnB,KAA4B,CAA5B,IAAiCjB,KAAK,CAACa,UAAN,CAAiB0B,MAAjB,KAA4B,CAA9D,kBACC;AAAA,8BACE,QAAC,IAAD;AAAM,QAAA,EAAE,EAAC,GAAT;AAAA,+BAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAb;AAAA;AAAA;AAAA;AAAA,cADF,EAEGvC,KAAK,CAACsC,IAAN,KAAe,IAAf,iBAAuB;AAAQ,QAAA,OAAO,EAAEtB,kBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAF1B,EAGGhB,KAAK,CAACsC,IAAN,KAAe,IAAf,iBAAuB;AAAQ,QAAA,OAAO,EAAEc,WAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAH1B;AAAA;AAAA;AAAA;AAAA;AAAA,YAhBJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAyBD,CA1JD;;GAAMrD,S;;KAAAA,S;;AAiLN,MAAMmE,eAAe,GAAIC,KAAD,KAA0C;AAChE5D,EAAAA,YAAY,EAAE4D,KAAK,CAAC5D,YAD4C;AAEhEM,EAAAA,UAAU,EAAEsD,KAAK,CAACtD,UAF8C;AAGhEyB,EAAAA,IAAI,EAAE6B,KAAK,CAAC7B,IAHoD;AAIhE8B,EAAAA,QAAQ,EAAED,KAAK,CAACE,OAJgD;AAKhEC,EAAAA,MAAM,EAAEH,KAAK,CAACI,KALkD;AAMhEtE,EAAAA,OAAO,EAAEkE,KAAK,CAAClE;AANiD,CAA1C,CAAxB;;AAUA,MAAMuE,kBAAkB,GAAIC,QAAD,KAAwC;AACjEb,EAAAA,aAAa,EAAEvC,EAAD,IAAQ;AAACoD,IAAAA,QAAQ,CAACnF,4BAA4B,CAAC+B,EAAD,CAA7B,CAAR;AAA2C,GADD;AAEjEL,EAAAA,kBAAkB,EAAC,CAACsB,IAAD,EAAaoC,KAAb,KAA+B;AAACD,IAAAA,QAAQ,CAACvF,yBAAyB,CAACoD,IAAD,EAAOoC,KAAP,CAA1B,CAAR;AAAiD,GAFnC;AAGjEC,EAAAA,SAAS,EAAE,MAAM;AAACF,IAAAA,QAAQ,CAAC1F,yBAAyB,EAA1B,CAAR;AAAsC,GAHS;AAIjEyD,EAAAA,eAAe,EAAC,CAAC3B,UAAD,EAA0ByB,IAA1B,KAAyC;AAACmC,IAAAA,QAAQ,CAACrF,sBAAsB,CAACyB,UAAD,EAAayB,IAAb,CAAvB,CAAR;AAAmD,GAJ5C;AAKjEuB,EAAAA,YAAY,EAAGxC,EAAD,IAAQ;AAACoD,IAAAA,QAAQ,CAACzF,yBAAyB,CAACqC,EAAD,CAA1B,CAAR;AAAwC,GALE;AAMjEyC,EAAAA,WAAW,EAAGzC,EAAD,IAAQ;AAACoD,IAAAA,QAAQ,CAACpF,wBAAwB,CAACgC,EAAD,CAAzB,CAAR;AAAuC,GANI;AAOjEkC,EAAAA,eAAe,EAAEqB,WAAD,IAAiB;AAACH,IAAAA,QAAQ,CAAClF,sBAAsB,CAACqF,WAAD,CAAvB,CAAR;AAA8C,GAPf;AAQjEzE,EAAAA,qBAAqB,EAAC,MAAM;AAACsE,IAAAA,QAAQ,CAACxF,0BAA0B,EAA3B,CAAR;AAAuC,GARH;AASjEmB,EAAAA,iBAAiB,EAAC,MAAM;AAACqE,IAAAA,QAAQ,CAACtF,uBAAuB,EAAxB,CAAR;AAAoC;AATI,CAAxC,CAA3B;;AAYA,eAAeN,OAAO,CAACqF,eAAD,EAAkBM,kBAAlB,CAAP,CAA6CzE,SAA7C,CAAf","sourcesContent":["import { connect } from 'react-redux'\nimport { Dispatch } from 'redux'\nimport { Link } from 'react-router-dom'\nimport { clearProductInCartRequest, minusProductInCartRequest, placePurchaseOrderNotAsked, placePurchaseOrderRequest, placeRentOrdersNotAsked, placeRentOrdersRequest, plusProductInCartRequest, removeProductFromCartRequest, removeRentOrderRequest } from '../../../../../store/actionCreators'\nimport { ApplicationState, Order, ProductModel, ProductOrder, RentOrder, User} from '../../../../../store/types'\nimport ChartProduct  from '../ChartProduct/ChartProduct'\nimport * as styles from './styles'\nimport ReactNotification, { store } from 'react-notifications-component'\nimport 'react-notifications-component/dist/theme.css'\nimport ChartRent from '../ChartRent/ChartRent'\nimport ProductList from '../ProductList'\nimport { ReactElement } from 'react'\nimport { useEffect } from 'react'\n\nexport interface ChartPageProps{\n  user: User | null;\n  cartProducts: Map<string, ProductModel>;\n  rentOrders: RentOrder[];\n  loadings: Map<String, boolean>;\n  errors: Map<String, boolean>;\n  success: Map<String, boolean>;\n  removeProduct: (id: string) => void;\n  removeRentOrder: (rentOrderId: number) => void;\n  minusProduct: (id: string) => void;\n\tplusProduct: (id: string) => void;\n  placePurchaseOrder:(user: User, order: Order) => void;\n  placePurchaseNotAsked:() => void;\n  placeRentOrders:(rentOrders: RentOrder[], user: User) => void;\n  placeRentNotAsked:() => void;\n  clearCart: () => void;\n}\n\nconst ChartPage: React.FC<ChartPageProps> = (props) => {\n\n  useEffect(() => {\n    if(props.success.get('placePurchaseOrder')){\n      props.placePurchaseNotAsked();\n    } else if (props.success.get('placeRentOrders')){\n      props.placeRentNotAsked();\n    }\n  }, [props.success]);\n\n  const getFinalPrice = () => {\n    let finalPrice: number = 0.0;\n\n    props.cartProducts.forEach((product) => {\n      finalPrice += parseFloat(product.price) * product.quantity;\n    });\n\n    props.rentOrders.forEach((rentOrder) => finalPrice += parseFloat(rentOrder.total));\n\n    return finalPrice;\n  }\n\n  const placePurchaseOrder = () => {\n\n    if(props.cartProducts.size !== 0){\n      let totalPrice: number = 0;\n      let productsOrders: ProductOrder[] = [];\n      \n      props.cartProducts.forEach((product) => {\n        totalPrice += parseFloat(product.price) * product.quantity;\n\n        const newProductOrder: ProductOrder = {\n          id: product.id, \n          name: product.name, \n          price: product.price, \n          quantity: product.quantity\n        }\n\n        // draft.products.forEach((value, idx) => {\n        //   if(value.id === product.id){\n        //     draft.products[idx].quantity -= product.quantity;\n        //   }\n        // })\n\n        productsOrders.push(newProductOrder);\n      });\n      \n      var day = new Date();\n      var dd = day.getDate().toString();\n      var mm = (day.getMonth()+1).toString();\n      var yyyy = (day.getFullYear()).toString();\n      if(parseInt(dd) < 10){\n        dd = '0' + dd;\n      } \n      if(parseInt(mm)<10){\n        mm = '0' + mm;\n      } \n\n      const newOrder: Order = {\n        productsOrders: productsOrders,\n        date: dd + \"/\" + mm + \"/\" + yyyy,\n        total: totalPrice.toFixed(2),\n        status: \"Preparando para envio!\",\n      }\n\n      props.placePurchaseOrder(props.user!, newOrder);\n    }\n\n    if(props.rentOrders.length !== 0) {\n      props.placeRentOrders(props.rentOrders, props.user!);\n    }\n\n    // props.clearCart();\n\n    store.addNotification({\n      title: \"Pedido feito com sucesso!\",\n      message: \" \",\n      type: \"success\",\n      insert: \"top\",\n      container: \"top-left\",\n      animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n      animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n      dismiss: {\n        duration: 2000,\n        onScreen: false\n      }\n      });\n  }\n  const notifyLogin = () => {\n      store.addNotification({\n        title: \"Por favor faça login antes de finalizar a compra.\",\n        message: \" \",\n        type: \"warning\",\n        insert: \"top\",\n        container: \"top-left\",\n        animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n        animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n        dismiss: {\n          duration: 2000,\n          onScreen: false\n        }\n      });\n  }\n\n  const renderRentOrder = (rentOrder: RentOrder, idx: number) => {\n    return (<ChartRent removeRentOrder={props.removeRentOrder} rentOrder={rentOrder}/>);\n  }\n\n  const renderProduts = (cartProducts: Map<string, ProductModel>) =>{\n\n    const cartProductElements: ReactElement[] = [];\n\n    cartProducts.forEach((cartProduct) => {\n      cartProductElements.push(\n        <ChartProduct \n          img={cartProduct.img} \n          name={cartProduct.name} \n          price={cartProduct.price} \n          quantity={cartProduct.quantity}\n          id={cartProduct.id} \n          removeProduct={props.removeProduct} \n          minusProduct={props.minusProduct}\n          plusProduct={props.plusProduct}\n        />);\n    });\n\n    return(cartProductElements);\n  }\n\n  return(\n    <div className={styles.productDisplay}>\n      <ReactNotification/>\n      <h1>Seus Produtos</h1>\n\n      \n      <div className={styles.productList}>\n        {/* {props.cartProducts.size !== 0 && renderProduts(props.cartProducts)} */}\n        {props.cartProducts.size !== 0 && <ProductList products={renderProduts(props.cartProducts)} title={\"Compras\"} />}\n        {/* {props.rentOrders.length !== 0 && props.rentOrders.map(renderRentOrder)} */}\n\n        {props.rentOrders.length !== 0 && <ProductList products={props.rentOrders.map(renderRentOrder)} title={\"Alugueis\"}/>}\n        {props.cartProducts.size === 0 && props.rentOrders.length === 0 && <h2>Você não tem nenhum produto no carrinho :(</h2>}\n      </div>\n      \n      {(props.cartProducts.size !== 0 || props.rentOrders.length !== 0) && <h1>Total: {\"R$ \" + getFinalPrice().toFixed(2)}</h1>}\n      {(props.cartProducts.size !== 0 || props.rentOrders.length !== 0) &&\n        <div>\n          <Link to=\"/\"><button>Continuar comprando</button></Link>\n          {props.user !== null && <button onClick={placePurchaseOrder}>Finalizar compra</button>}\n          {props.user === null && <button onClick={notifyLogin}>Finalizar compra</button>}\n        </div>\n      }\n    </div>\n  );\n}\n\ninterface DispatchProps {\n  removeProduct: (id: string) => void;\n  minusProduct: (id: string) => void;\n\tplusProduct: (id: string) => void;\n  removeRentOrder: (rentOrderId: number) => void;\n  placePurchaseOrder:(user: User, order: Order) => void;\n  placeRentOrders:(rentOrders: RentOrder[], user: User) => void;\n  placePurchaseNotAsked:() => void;\n  placeRentNotAsked:() => void;\n  clearCart: () => void;\n}\n\ninterface StateProps{\n  loadings: Map<String, boolean>;\n  errors: Map<String, boolean>;\n  success: Map<String, boolean>;\n  cartProducts: Map<string, ProductModel>;\n  rentOrders: RentOrder[];\n  user: User | null;\n}\n\nconst mapStateToProps = (state: ApplicationState): StateProps => ({\n  cartProducts: state.cartProducts,\n  rentOrders: state.rentOrders,\n  user: state.user,\n  loadings: state.loading,\n  errors: state.error,\n  success: state.success\n  \n});\n\nconst mapDispatchToProps = (dispatch: Dispatch): DispatchProps => ({\n  removeProduct:(id) => {dispatch(removeProductFromCartRequest(id))},\n  placePurchaseOrder:(user: User, order: Order)  => {dispatch(placePurchaseOrderRequest(user, order))},\n  clearCart: () => {dispatch(clearProductInCartRequest())},\n  placeRentOrders:(rentOrders: RentOrder[], user: User) => {dispatch(placeRentOrdersRequest(rentOrders, user))},\n  minusProduct: (id) => {dispatch(minusProductInCartRequest(id))},\n  plusProduct: (id) => {dispatch(plusProductInCartRequest(id))},\n  removeRentOrder:(rentOrderId) => {dispatch(removeRentOrderRequest(rentOrderId))},\n  placePurchaseNotAsked:() => {dispatch(placePurchaseOrderNotAsked())},\n  placeRentNotAsked:() => {dispatch(placeRentOrdersNotAsked())}\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChartPage);"]},"metadata":{},"sourceType":"module"}